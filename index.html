<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1, minimum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffffff">

    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="style.css" />
    <title>PWA Fullscreen Test</title>
  </head>
  <body>
    <div id="bit-text"></div>
    <canvas id="canvas"></canvas>
    <script>
      document.getElementById('bit-text').textContent = `"${window.location.href}"`;

      const canvas = document.getElementById('canvas');

      function resizeCanvasToDiv() {
        const divWidth = window.screen.width;
        const divHeight = window.screen.height;

        // 设置 canvas 绘图表面的实际宽度和高度
        canvas.width = divWidth;
        canvas.height = divHeight;

        console.log(`Canvas resized to: ${canvas.width}x${canvas.height}`);
        drawContent();
      }

      // 页面加载时调整一次尺寸
      requestAnimationFrame(resizeCanvasToDiv);

      // 监听窗口大小变化事件，实时调整 canvas 尺寸
      window.addEventListener('resize', resizeCanvasToDiv);

      function drawContent() {
        const ctx = canvas.getContext('2d');
        ctx.strokeStyle = 'yellow';
        ctx.lineWidth = 10;
        ctx.strokeRect(5, 5, canvas.width - 10, canvas.height - 10);

        const sat = parseInt(getComputedStyle(canvas).getPropertyValue('--sat'));
        const sar = parseInt(getComputedStyle(canvas).getPropertyValue('--sar'));
        const sab = parseInt(getComputedStyle(canvas).getPropertyValue('--sab'));
        const sal = parseInt(getComputedStyle(canvas).getPropertyValue('--sal'));

        const safeAreaWidth = canvas.width - sal - sar;
        const safeAreaHeight = canvas.height - sat - sab;
        console.log('safeAreaWidth', safeAreaWidth, 'safeAreaHeight', safeAreaHeight);
        
        // 绘制半透明蓝色方块
        ctx.fillStyle = 'rgba(0, 0, 255, 0.3)';
        ctx.fillRect(
          sal,
          sat,
          safeAreaWidth,
          safeAreaHeight
        );
      }
      
    </script>
  </body>
</html>
